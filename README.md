# 職務経歴書

## 基本情報

|key|value|
|---|-----|
|Name|南 優也 (みなみ ゆうや)|
|Twitter|[@mooonyman](https://mobile.twitter.com/mooonyman)|
|GitHub|[yuya373 (Yuya Minami)](https://github.com/yuya373)|
|はてなブックマーク|[mooonymann](http://b.hatena.ne.jp/mooonymann/)|

## スキル

- Ruby
  - Ruby on Rails
- Rust
  - actix-web
  - diesel
  - axum
  - sqlx
- TypeScript
  - React
  - ReactNative
    - Expo(v33.0.3)
  - Redux
  - TanStack Query
- Scala (v2.11)
  - Finagle
  - Finch
  - TwitterServer
- Emacs Lisp
  - プラグイン
    - [yuya373/emacs-slack: slack client for emacs](https://github.com/yuya373/emacs-slack)
    - [yuya373/gh-viewer](https://github.com/yuya373/gh-viewer)
    - [yuya373/emacs-github-graphql-client](https://github.com/yuya373/emacs-github-graphql-client)
    - [yuya373/emacs-bq: emacs "bq" command interface](https://github.com/yuya373/emacs-bq)



## 職務経歴

### 2020/05 - : 株式会社ペイルド
2020年8月にリリースされたクラウド型法人カード「paild（ペイルド）」の開発に取り組みました。
paildのカード開発チーム（PO1人、デザイナー1人、エンジニア3人）に属し、プロダクトオーナーが収集した要望をGitHub Issueにまとめ、エンジニアがその実現方法を検討し、タスクに分割して実装を進めました。

技術スタックは、フロントエンドにReactとTypeScript、バックエンドにRust、axum、sqlx、utopiaを使用しました。主な機能には、法人向けプリペイドカードの発行、支出管理機能、証憑管理機能、API連携（freee、MoneyForward）などが含まれます。また、ユーザーがログイン不要で領収書ファイルや税区分、取引種目を登録できる機能を実装し、操作性を向上させました。

#### 担当したプロジェクト事例
##### 証憑管理機能
* **開発環境とチーム編成**
    * 開発環境：
        * フロントエンド：React, TypeScript
        * バックエンド：Rust, axum, sqlx, utopia
    * チーム編成：カード開発チーム（PO1人、デザイナー1人、エンジニア3人）
* **当時の状況**
    * 課題：
        * 顧客が増える中で、ログインせずに、モバイルだけで領収書や品目名をアップ・更新したいニーズが顕在化
        * 改正電帳法への対応やインボイス制度の導入に伴い、証憑管理の自動化と精度向上が急務となっていた
* **行動・判断**
    * POが整理した要望をチームで設計に落とし込み、実装まで進めた。エンジニアの中に、リーダーや設計担当がいるわけではなく、エンジニア同士で議論する中で、その時点で最も良い設計を採用するスタイルを取った。
    * 実装
        * 利用明細にレシート等の証憑を添付できる機能を実装
        * 利用通知のメールにファイルを添付して返信することで証憑をアップロードできるようにする機能を実装
        * アップロードされた証憑からOCRによって登録番号、金額、利用日等の情報を読み取る機能を実装
        * 利用通知のメールからログイン不要で証憑のアップロードと支出の入力ができる機能を実装
        * 支出のレビュー機能を実装
    * 苦労したこと
        * ユーザーが、カード利用通知メールに、領収書ファイルを返信するだけで、証憑をアップロードできる機能を実装した
            * **メールパーサーの実装** ：ユーザーが利用通知メールに返信して、スマートフォンで撮影して添付した証憑ファイルをアップロードできるようにするため、メールパーサーを使ってファイルを分離し取得する処理を実装した。また、ユーザーから受け取ったメールはS3に保管し、Lambda上でファイルを抜き出し保存するフローを構築した。
            * **モデルの複雑さ** ：メール経由でアップロードされたファイルの形式や付与されるデータ（EXIF情報など）の処理が複雑で、各形式に対応するための処理ロジックを構築するのが困難だった。
            * **アップロード経路の多様さ** ：メール、管理画面、SaaS管理経由など、複数の経路からアップロードされるファイルに対応するため、統一的な処理フローを設計する必要があった。
            * **非同期処理の実装** ：アップロードされたファイルのOCR処理は非同期で行うよう実装した。
            * **段階的な機能拡張** ：最初は登録番号だけをOCRで読み取る機能リリースだったが、後に金額も利用したいニーズが生まれた。そのニーズを解消する際に、以前から取得していたOCR結果のデータから金額をマイグレーションした。
            * **国税庁APIとの連携** ：国税庁のAPIを利用して、登録番号とカード決済日を組み合わせてリクエストし、インボイス制度への対応を確認する必要があったが、APIの仕様が事前に明らかになっていない部分もあり、適応するのに苦労した。
        * ユーザーが、カード利用通知メールのURLから、”ログイン不要”で領収書ファイルや、税区分・取引種目などを登録できる機能を実装した
            * **トークン付きリンクの発行** ：1時間以内に利用できるトークン付きリンクを発行し、その期間内であれば品目やファイルをアップロードできる画面を作成することに注力した。特に、リンクの有効期限を厳密に管理し、不正利用を防止するためのセキュリティ対策を徹底することが必要であった。
            * **データのフィルタリング** ：ログイン不要画面では、通常のAPIで返すデータであっても、見られてはいけない情報を適切にフィルタリングする必要があった。そのため、表示するデータをプロダクトオーナー（PO）と詳細に要件をすり合わせながら実装した。特に、セキュリティとユーザビリティのバランスを取ることが重要であり、どの情報を表示し、どの情報を隠すかを慎重に決定した。
* **成果・結果**
    * ユーザーがログインすることなく、必要な情報を登録・更新できる体験を作ることができた。飲食店の店長など、日常的にパソコンを利用しないユーザーから非常に利用しやすくなったとの反響を得て、製品独自の強みを作ることができた。
    * リリース記事
        * [カード決済後に届くメールから、領収書と利用用途をまとめて登録可能に](https://www.paild.io/updates/20231206/)
        * [カード利用通知メールへの返信で証憑ファイルをアップロードできるようになりました｜paild（ペイルド）](https://www.paild.io/updates/20220907/)
        * [改正電帳法準拠の証憑管理、支出の事後承認ができるようになりました｜paild（ペイルド）](https://www.paild.io/updates/20220815/)
        * [AI-OCRによる登録番号の読み取り・自動判定ほかインボイス制度に対応しました](https://www.paild.io/updates/20230830/)
        * [【2022年12月の機能リリース】入出金履歴・利用明細一覧の新デザインをリリースほか｜paild（ペイルド）](https://www.paild.io/updates/2022-12-01/)
        * [SaaS管理機能と証憑管理機能を統合しました｜paild（ペイルド）](https://www.paild.io/updates/2022-10-19/)

---

##### カードの利用制限ルール拡張
* **プロジェクト期間**：1~2ヶ月程度
* **開発環境とチーム編成**
    * 開発環境：
        * フロントエンド：React, TypeScript
        * バックエンド：Rust, axum, sqlx, utopia
    * チーム編成：カード開発チーム（PO1人、デザイナー1人、エンジニア3人）
* **当時の状況**
    * 課題：
        * 月ごとの上限を設定する機能があったが、顧客のニーズを十分に満たすには不十分であった。顧客からのフィードバックを基に、より詳細な制限を追加する必要があった。顧客の要望をプロダクトオーナー（PO）が整理し、エンジニアが仕様や設計について議論しながら決定することとなった。
    * 自分の役割・ミッション：利用制限ルールの拡張
* **行動・判断**
    * 実装
        * 初期：
            * 月額の利用上限（翌月1日にリセット）
        * 追加：
            * 日次の利用上限：毎日0時に利用可能額を設定額まで回復
            * 週次の利用上限：毎週日曜に利用可能額を設定額まで回復
            * 年次の利用上限：年初1月1日に利用可能額を設定額まで回復
            * １決済あたりの利用上限：上限を超える決済が不可
            * 合計の利用上限：設定以後、通算で利用できる使い切り額を設定
            * カード利用の期間制限：開始日～終了日の間の期間でのみ利用できる
    * 苦労したこと
        * **エラーメッセージの考慮：** 複数の上限に同時に該当する場合、ユーザーに分かりやすくエラーメッセージをまとめて返すロジックを設計した。
        * **条件の判定：** 年次、週次、日次の各制限を効率的に計算し、複数の条件が組み合わさった場合でも高いパフォーマンスを維持するための計算処理を実装する必要があった。
* **成果・結果**
    * 顧客に早く価値を提供するため、コア機能を小分けにして実装し、市場に順次リリースすることで、迅速に顧客のニーズに応えることができた。
    * リリース記事
        * [すべてのカードで高度な利用制限を利用できるようになりました｜paild（ペイルド）](https://www.paild.io/updates/advanced-card2/)
        * [使い切り額でカード利用枠を設定できるようになりました｜paild（ペイルド）](https://www.paild.io/updates/additional-limitation-for-advanced-card/)
        * [カード利用について、複数のルールを組み合わせてカスタマイズした制限を適用できるようになりました｜paild（ペイルド）](https://www.paild.io/updates/advanced-card/)

---

##### 会計ソフトとの連携
* **プロジェクト期間**：1~2ヶ月程度
* **開発環境とチーム編成**
    * 開発環境：
        * フロントエンド：React, TypeScript
        * バックエンド：Rust, axum, sqlx, utopia
    * チーム編成：カード開発チーム（PO1人、デザイナー1人、エンジニア3人）
* **当時の状況**
    * 課題：
        * ユーザーが日々の取引データを手動で会計ソフトに入力する手間を省き、ミスを減らすために、会計ソフトとシステムのデータ連携が求められていた。具体的には、freeeやマネーフォワードなどの主要な会計ソフトとのAPI連携を構築し、自動的に取引データを転送する必要があった。また、これにより会計処理の効率化と精度向上を図ることが目標であった。
* **行動・判断**
    * 実装
        * freee, マネーフォワードとのAPI連携を実装
        * CSVによる弥生会計、勘定奉行への連携を実装
    * 苦労したこと
        * **API仕様の調査と対応**：freeeやマネーフォワードのAPIドキュメントを調査し、エンドポイントごとの制限やデータフォーマットの違いを把握することに注力した。特に、freeeの場合、自社で実際に利用しながらAPIと実際の画面を照らし合わせて検証を行い、API仕様書通りに動かない点を詳細に調査しエラーを特定・解決した。
        * **想定外の不具合対応**：上述のAPI仕様書通りに動かない点や、ユーザーがログインできていないにも関わらずAPI的には接続状態になっているなど、予期しないエラーに対しても適切に対応した。
* **成果・結果**
    * 会計ソフトとのスムーズなデータ連携を実現し、ユーザーの手間を大幅に削減するとともに、取引データの正確性を向上させた。これにより、会計処理の効率化と精度向上を達成した。
    * リリース記事
        * [freeeとのAPI連携を開始しました｜paild（ペイルド）](https://www.paild.io/updates/freee-api-connect/)
        * [マネーフォワードとのAPI連携を開始しました｜paild（ペイルド）](https://www.paild.io/updates/mf-api-connect/)

---

#### その他の経験
##### メールによる通知機能
* **当時の状況**
    * 課題：入金決済する際に、ログインをして残高を確認しないと決済が完了したのかわからず、ユーザーが不安を抱えていた。飲食店の店長など、モバイル機器などで迅速に確認したい状況があった。
* **行動・判断**
    * 実装
        * 決済が成功した時の通知：管理者が適切に利用されているか知るため、残高等の情報も記載
        * 決済が失敗した時の通知：失敗理由がすぐにわかるように通知
        * 入金された時の通知：ログインの手間を減らす
* **成果・結果**
    * [管理者へカード決済を通知する機能を追加しました｜paild（ペイルド）](https://www.paild.io/updates/notification-of-settlement/)
    * [決済に失敗した際に理由がメールで通知されるようになりました｜paild（ペイルド）](https://www.paild.io/updates/email-notification-on-fail-payment/)
    * [入金反映時にメールで通知がされるようになりました](https://www.paild.io/updates/email-notification-on-deposit/)


##### SaaS管理機能
* **実装**
    * SaaS毎にユニークなメールアドレスを払い出して、領収書の回収を簡単にする機能を実装
    * SaaS毎にバーチャルカードを発行できるようにする機能を実装
* リリース記事
        * [SaaSの証憑回収管理機能のβ版をリリースしました](https://www.paild.io/updates/saas-expenses-management/)

##### 明細一覧のリデザイン
* **実装**
    * 証憑の登録状況やレビューの状況等の検索条件の拡張
    * 表示する項目、検索条件をセットで保存できる機能を実装

#### カード開発チーム以外での経験
##### 運用向け管理画面の開発
社内の運用チームが使う管理画面

* ウォレットを凍結
* ウォレット毎の管理者のメールアドレスを取得
* 残高証明書等の作成に必要な情報の取得

など、運用チームが必要な機能が実装されている管理画面

* フロントエンド
    * React, TypeScript

##### カード管理サービスの開発
Rust, axum, sqlx等

* カード番号やPIN等の情報を扱うサービス
* 印刷会社にリアルカードの発行を依頼したりもする
* PCI-DSSの要件を満たすため他のサービスとは隔離されている

カード券面のデザイン修正等で必要になった改修を行った

### 2019/03 - 2020/04 : 株式会社maricuru
職務: ソフトウェアエンジニア
環境: Ruby(2.x), Ruby on Rails(5.x), Grape(0.19) MySQL(RDS), Redis(ElastiCache), ReactNative, Expo, Redux, ECS, Amazon Elastic Search Service

#### ReactNativeアプリの開発
- [結婚式準備の相談サイト【maricuru】](https://maricuru.com/pages/app/)のアプリ開発
  - 既存コードのTypeScript化
  - パフォーマンスチューニング
    - `PureComponent`, `react-redux`の`Connect`等を使って`render`回数を減らす
    - `requestAnimationFrame`での遅延レンダリング
    - カルーセルでのオンメモリ状態の画像を減らすことでのメモリ使用量の削減
  - `redux-thunk`を用いてコンポーネントから副作用のあるコードの分離
  - 画像アップロード方法の改善
    - クライアント → サーバー → S3 から クライアントから直接S3へアップロードするように
  

#### WebAPIの開発
- 上記アプリのAPI開発
- パフォーマンスチューニング
  - 遅いクエリの改善
    - index追加
    - クエリ自体の修正
  - n+1の修正
  - jbuilderから[procore/blueprinter](https://github.com/procore/blueprinter)への移行
  - 遅いAPIにページネーションの導入
- imgix導入

#### インフラ環境の整備
- 既存インフラのterraform(0.11.11)化
- cronからECS Scheduled Tasksへの移行


### 2016/01 - 2019/02 : 株式会社Rebase
職務: Webアプリケーションエンジニア
環境: Ruby(2.x), Ruby on Rails(4.x), PostgreSQL(RDS), Redis(ElastiCache), Webpack, React, Redux, ECS, Scala(2.11), Finagle, Finch, Elastic Beanstalk, Amazon Elastic Search Service

#### Webアプリケーションの開発
- [貸し会議室・レンタルスペースの検索・予約なら | インスタベース](https://www.instabase.jp/)の開発
  - バックエンド
    - Ruby, Ruby on Rails
    - Sidekiq, AWS Batchを使った非同期,バッチ処理
    - Google Calendar連携
    - 決済を非同期にする
    - 検索時の合計料金
  - フロントエンド
    - Haml, Sass
    - React, Redux, Immutable.js等でのSPA、コンポーネント開発
      - 検索ページ
        - https://www.instabase.jp/search
      - スペース登録、編集フォーム
      - トップページ
       - https://www.instabase.jp
    - フロントエンドのパフォーマンスチューニング
      - オフスクリーンイメージの遅延読み込み
      - jsの分割
      - Reactコンポーネントのパフォーマンスチューニング
    - webpackのアップデート(1.x -> 4.x)
  - CI, CD
    - Circle CI
    - eslint, stylelintでリント
    - Rspec, capybara等でテスト

#### 検索APIサーバーの開発
- 主に[検索ページ](https://www.instabase.jp/search)で使われるAPIサーバーの開発
  - Scala, Finagle, Finch
  - 管理画面はTwitterServer
  - JSONを返す
  - Web(XHR)、Rubyからアクセス
  - DB
    - PostgreSQL(RDS)
    - Elastic Search(以下、ES)
      - ES内ドキュメントの検索、更新、追加、削除
  - API
    - 日時による検索
    - 緯度・経度による検索
    - フリーワードによる検索
    - 都道府県、設備等の条件による検索

### 2014/08 - 2015/12: 株式会社アカツキ
職務: サーバーサイドエンジニア
環境: Ruby(2.x), Ruby on Rails(4.x), MySQL(RDS), Redis(ElastiCache), CloudFront, EC2等

#### ゲームAPIサーバーの開発
- スマートフォンゲームのAPI開発
- ガチャ、ログインボーナス、インゲーム開始/終了、キャラクター合成/進化等
